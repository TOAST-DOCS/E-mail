## Notification > Email > コンソール使用ガイド

## メールの送信

### 一般メールの送信

受信者、タイトル、内容、添付ファイルなどを入力してメールを送信できます。
一般メールを送信する場合、受信者を直接入力する必要があります。

![email_01_201812](https://static.toastoven.net/prod_email/email_01_201812_en.png)

**メール送信**タブの**テンプレート使用**で**未使用**を選択します。
**メール区分**で**一般メール**を選択します。
**送信メール**：送信メールアドレスを入力します。名前<emailAddress>形式で作成すると、送信者の名前とメールアドレスを入力できます。
**予約送信**：メール送信予約日時を指定できます。
**添付ファイル**：メールに添付ファイルを追加します。

- 添付ファイルは最大10個まで、30MB以下のファイルのみアップロードできます。
- 添付ファイルの容量は、合計30MBが上限です。
- 最大30MBまで添付可能ですが、受信するメールシステムによっては「制限超過」となって拒否されたり、スパムと判定される確率が上がる場合があります。10MB以内の利用を推奨します。

**タイトル**/**内容**：メールのタイトルと内容を入力します。

![email_02_201812](https://static.toastoven.net/prod_email/email_02_201904_en.png)

画面の下にある**受信者**と**CC**にメールアドレスを入力します。

### 広告性メールの送信
広告性メールを送信できます。

#### 広告メール送信時の注意事項
韓国情報通信網法に従い、商業性広告メールや業者の広告メールを送信する場合、下記の事項を遵守する必要があります。 [[韓国インターネット振興院関連の内容を確認](https://spam.kisa.or.kr/spam/sub62.do)]

1. 広告性メールは、受信に同意した受信者にのみ送信する必要があります。

これに違反してトラブルが発生した場合、その責任は広告メール送信者にあります。

2. タイトルの始めに(広告)という文言を表示する必要があります。
3. 本文に送信者の名称、メールアドレス、電話番号およびアドレスを含む送信者情報を表示する必要があります。
4. 本文に受信者が簡単に受信拒否または受信同意の撤回を意思表示できるようにするための案内文を明示し、受信拒否または受信同意の撤回を簡単に選択できるような技術的な措置が必要です。

NHN Cloudは、韓国情報通信網法を遵守できるように、'広告メール'に下記のような技術的措置を提供します。
* タイトルに(広告)という文言を挿入します。
* 受信者が受信拒否を選択できるように、受信拒否機能を提供します。
* 受信拒否対象のメールアドレスには広告メールを送信しません。

広告性メールの送信時、下記の項目を参照してください。

![email_03_201812](https://static.toastoven.net/prod_email/email_03_201812_en.png)

1. タイトルに"(広告)"という文言を必ず入れます。

2. 受信拒否リンクが日本語/英語の形式で必ず入る必要があります。

3. 受信拒否に登録されているユーザーは、広告性メール送信時に送信されません。

次は、受信拒否リンクで提供しているキーです。

| キー                      | 文言 | 使用例                                                                                                                           |
|-------------------------| - |-------------------------------------------------------------------------------------------------------------------------------|
| EN_BLOCK_RECEIVER_LINK  | [Unsubscription](#) | If you no longer wish to receive these emails, please click the ##EN_BLOCK_RECEIVER_LINK##.                                   |
| JA_BLOCK_RECEIVER_LINK  | [受信拒否](#) | メールの受信を希望しない場合、##JA_BLOCK_RECEIVER_LINK##をクリックしてください。                                                                         |
| BLOCK_RECEIVER_LINK_URL | - | If you no longer wish to receive these emails, please `<a href='##BLOCK_RECEIVER_LINK_URL##' target='_blank'>click here</a>`. |

### テンプレートを利用したメール送信

あらかじめ作成しておいたメールテンプレートを使用できます。

![email_04_201812](https://static.toastoven.net/prod_email/email_04_201812_en.png)

1. テンプレートを使用するには、**テンプレート使用**で**使用**を選択します。
2. 有効になった**テンプレート選択**をクリックします。
3. **テンプレート選択**ウィンドウのカテゴリーで、あらかじめ作成しておいたテンプレートを選択します。 
    - テンプレートの作成方法は、下記の**カテゴリーおよびテンプレート管理**の項目を参照してください。
4. **テンプレート適用**ボタンをクリックします。

### タグを使用したメール送信

タグを使用してメールを送信できます。
タグについての詳細は、**[概要](Overview.md)**文書の**タグを使用して送信**を参照してください。

**メール送信**タブの**テンプレート使用**で**未使用**を選択し、**メール区分**で**一般メール**を選択します。

- **送信メール**：送信メールアドレスを入力します。名前<emailAddress>形式で作成すると、送信者名とメールアドレスを入力できます。
- **予約送信**：メール送信予約日時を指定できます。
- **添付ファイル**：メールに添付ファイルを追加します。
  - 添付ファイルは最大10個まで、30MB以下のファイルのみアップロードできます。
  - 添付ファイルの容量は、合計30MBが上限です。
- **タイトル**/**内容**：メールのタイトルと内容を入力します。

![email_05_201812](https://static.toastoven.net/prod_email/email_05_201812_en.png)

1. 画面下で**タグ送信**タブを選択し、**タグ選択**ボタンをクリックします。
    - タグを登録する方法は、**タグ管理**を参照してください。

2. **タグ選択**ウィンドウで送信したいタグを選択します。
3. **選択適用**ボタンをクリックします。
4. 最大4個のタグを選択できます。
    - 選択した複数のタグにAND、OR条件を適用できます。
        - AND：複数のタグに全て属す受信者のみを対象にする。
        - OR：複数のタグのうち、1つ以上のタグに属す受信者を対象にする。

![email_06_201812](https://static.toastoven.net/prod_email/email_06_201812_en.png)

メール内容入力ボックスの右下にある**送信予約**ボタンをクリックします。
**送信予約**ウィンドウが表示されたら、希望するボタンをクリックします。

- **確認後に進行**：受信者別にメールアドレスと送信内容を**タグメール送信照会**タブで確認後にメールを送信できます。登録後、**7日以内**に送信をリクエストしない場合、データが削除され送信できません。(予約送信ではサポートしません。)
- **即時送信**：受信情報を確認せずに即時にメールを送信します。送信結果はタグメール送信照会タブで確認できます。

### ファイルアップロードによる大量メール送信

ファイルを利用して大量メールを送信できます。

**メール送信**タブの**テンプレート使用**で**未使用**を選択し、**メール区分**で**一般メール**を選択します。

![email_07_201812](https://static.toastoven.net/prod_email/email_07_201812_en.png)

1. 送信メール情報を入力します。
    - **送信メール**：送信メールアドレスを入力します。名前<emailAddress>形式で作成すると、送信者名とメールアドレスを入力できます。
    - **予約送信**：メール送信予約日時を指定できます。
    - **添付ファイル**：メールに添付ファイルを追加します。
      - 添付ファイルは最大10個まで、30MB以下のファイルのみアップロードできます。
      - 添付ファイルの容量は、合計30MBが上限です。
    - **タイトル**/**内容**：メールのタイトルと内容を入力します。メールのタイトルと内容に##置換キー##の形式で入力すると、メール内容をユーザーが指定したデータに置換して送信できます。例えば、ユーザー名が入る部分に'##name##さん'と入力すると、'山田太郎'と、ユーザーが指定した名前に置換されて送信されます。

2. 画面下にある**大量送信**タブで**テンプレートのダウンロード**をクリックします。

3. テンプレートはCSVとExcelファイル形式で提供します。

![email_08_201812](https://static.toastoven.net/prod_email/email_08_201812_en.png)

テンプレートファイルに受信者のメールアドレスと名前など、置換キーに指定する置換データを入力します。

4. **受信者ファイルのアップロード**をクリックして作成したファイルをアップロードします。
    - テンプレートデータを入れたファイルは最大1万名、そして3MBまでアップロードできます。
    - テンプレートデータにエラーがある場合、エラー情報が表示されます。エラーの内容を確認して修正します。
    - エラーは総エラー件数と内容(最大10件)を表示します。
        - **エラーの種類**
            - receive_mail_address列が存在しない場合：receive_mail_address列は受信者のメールアドレスを入力する列のため、入力は必須です。
            - 入力されたデータがない場合
            - 受信者のメールアドレスまたは置換データの入力がない場合

5. メール内容入力ボックスの右下にある**送信予約**ボタンをクリックします。
6. **送信予約**ウィンドウが表示されたら、希望するボタンをクリックします。
    - **確認後に進行**：受信者別にメールアドレスと送信内容を**タグメール送信照会**タブで確認後にメールを送信できます。登録後、**7日以内**に送信をリクエストしない場合、データが削除され送信できません。(予約送信ではサポートしません。)
    - **即時送信**：受信情報を確認せずに即時にメールを送信します。送信結果はタグメール送信照会タブで確認できます。

## 送信照会


### メールリクエスト別照会

**メールリクエスト別照会**タブで送信日時、受信日時、テンプレート、送信ステータスなどの条件で送信されたメールを照会できます。

![email_18_201812](https://static.toastoven.net/prod_email/email_18_201812_en.png)

リストにあるメール内容をクリックすると、詳細送信内容を確認できます。

![email_19_201812](https://static.toastoven.net/prod_email/email_19_201812_en.png)

### 大量メール送信照会

**大量メール送信照会**タブでは、大量メール送信予約の照会や、送信または送信取消ができます。

![email_09_201812](https://static.toastoven.net/prod_email/email_09_201812_en.png)

  - **送信**をクリックするとメールを送信します。メール送信件数によっては、かなり時間がかかることがあります。
  - **取消**をクリックすると、メール送信をキャンセルします。

**大量メール送信進行状態**

  - 待機：受信者ファイルデータの読み込み作業を進行する前の状態です。
  - 送信準備：受信者ファイルデータ情報をロード中の状態です。
  - 送信準備完了：メール送信準備が完了した状態です。予約件(リストの行)を選択すると、受信者別メール送信内容を下段リストで確認できます。
  - 送信待機：メール送信作業待機中の状態です。
  - 送信中：メール送信が進行中の状態です。予約件(リストの行)を選択すると、送信進行率を確認できます。
  - 送信完了：送信が正常に完了された状態です。
  - 送信失敗：送信進行中に送信エラーが発生した場合です。メール別送信ステータスは、メール受信照会リストで確認できます。
  - 送信取消：ユーザーがメールの送信をキャンセルした状態です。

**受信者別メール送信照会**

![email_10_201812](https://static.toastoven.net/prod_email/email_10_201812_en.png)

1. 大量メール送信予約件(リストの行)を選択します。
2. 下段のリストで受信者別メール送信履歴が表示されます。**詳細表示**ボタンをクリックします。
3. メール詳細照会モーダルウィンドウで置換されたメール送信内容を確認できます。

### タグメール送信照会タブ
**タグメール送信照会**タブでは、タグメール送信予約の照会や、送信、送信取消ができます。

![email_11_201812](https://static.toastoven.net/prod_email/email_11_201812_en.png)

- **送信**をクリックするとメールを送信します。メール送信件数によっては、相応の時間がかかることがあります。
- **取消**をクリックすると、メールの送信をキャンセルします。

**タグメール送信進行状態**

- 待機：受信者ファイルデータの読み込み作業を進行する前の状態です。
- 送信準備：受信者ファイルデータ情報をロード中の状態です。
- 送信準備完了：メール送信準備が完了した状態です。予約件(リストの行)を選択すると、受信者別メール送信内容を下段リストで確認できます。
- 送信待機：メール送信作業待機中の状態です。
- 送信中：メール送信が進行中の状態です。予約件(リストの行)を選択すると、送信進行率を確認できます。
- 送信完了：送信が正常に完了された状態です。
- 送信失敗：送信進行中に送信エラーが発生した場合です。メール別送信ステータスは、メール受信照会リストで確認できます。
- 送信取消：ユーザーがメールの送信をキャンセルした状態です。

**受信者別メール送信照会**

![email_12_201812](https://static.toastoven.net/prod_email/email_12_201812_en.png)

タグメール送信予約件(リストの行)を選択すると、下段のリストで受信者別メール送信履歴を照会できます。

## カテゴリーおよびテンプレート管理

カテゴリーを作成した後、メール送信時に使用するテンプレートを分類して管理できます。

![email_13_201812](https://static.toastoven.net/prod_email/email_13_201812_en.png)

1. 左側にある**カテゴリー**でカテゴリーを選択します。
2. **カテゴリー追加**ボタンをクリックします。
    - カテゴリーを先に選択した状態で、**カテゴリー追加**ボタンをクリックする必要があります。
3. **カテゴリー追加**ウィンドウが表示されたら内容を入力します。
4. **追加**ボタンをクリックします。

- カテゴリーを修正するには、先に修正するカテゴリーを選択した後、**修正**ボタンをクリックします。**カテゴリー修正**ウィンドウが表示されたら内容を入力して**修正**ボタンをクリックします。

![email_14_201812](https://static.toastoven.net/prod_email/email_14_201812_en.png)

1. テンプレートを追加するには、先に作成されたカテゴリーを選択した後、**テンプレート追加**ボタンをクリックします。
2. よく使用する内容を作成します。
3. 右上にある**追加**ボタンをクリックします。

## メールドメイン管理

**メールドメイン管理**タブで送信メールドメインを管理できます。
送信メールのドメインを個人または会社で所有している場合、第三者により悪用される可能性がある問題点を補完できる機能です。

* メールサービスを利用するために必ず行う必要がある部分ではありません。
* 個人または会社で所有しているドメインではない場合、使用できません。
    * Daum、Naver、Googleなどのメールアカウント発行サービスを提供する業者のドメインは使用できません。

### メールドメイン登録
**メインドメイン登録**ボタンをクリックして送信メールで使用するドメインを登録できます。
ドメイン登録はルートドメインのみ登録できます。

### メールドメイン認証
**認証する**ボタンをクリックしてドメインの所有権を認証できます。
ドメイン登録時、発行されたトークンの値をドメインのTXTレコードに登録した後、**認証する**ボタンをクリックします。<br>

* ドメインのTXTレコードに"toast-domain-verification={トークン}"の値が存在しないか、値が一致しない場合、認証が失敗します。
* ドメインにTXTレコードを登録した後、変更事項が配信されるまでは時間がかかる場合があります。

### メールドメイン保護
**保護する**ボタンをクリックしてドメインを保護できます。
ドメインを保護すると、下記の事項が適用されます。<br>

* 保護されたドメインは、すでに認証されたプロジェクトでのみ使用できます。
    * 同じドメイン認証されたプロジェクトが複数ある時、そのうち1つのプロジェクトにのみ保護適用をした場合でも、認証された全てのプロジェクトがドメインを使用できます。
    * 例)プロジェクトA、Bのメールサービスで"toast.com"ドメインが認証された後、プロジェクトAで保護適用を進行
        * プロジェクトA、Bでのみ"toast.com"ドメインを送信アドレスとして使用可能
        * Cプロジェクトでは"toast.com"ドメインが認証されていないため、"toast.com"ドメインを送信アドレスとして使用できない

### メールドメイン共有
**共有 > 設定**ボタンをクリックするとドメインを共有できます。
主な機能は次のとおりです。<br>

* ドメインを認証されたプロジェクトの照会
    * 特定ドメインの認証手順が完了したNHN Cloudプロジェクトリストを提供します。
* ドメインを他のプロジェクトへ共有
    * 複数のプロジェクトで同じドメインを認証する時、認証プロセスを複数回進行する必要がありません。<br>
    * 1つのプロジェクトで認証された後、共有機能を活用して他のプロジェクトのメールサービスアプリケーションキーを入力するとドメインの共有が可能です。

### サブドメインの登録
**メインサブドメイン > 設定**ボタンをクリックしてサブドメインを登録できます。
登録されたルートドメインのサブドメインのみ登録できます。
登録されたサブドメインはメール送信時、**カスタムヘッダ(custom header)**機能で利用できます。

* サブドメインを使用できるカスタムヘッダ(custom header)
    * ヘッダ名： X-TC-ENVELOPE-FROM
    * ヘッダ値：サブドメイン
    * 主な機能は次のとおりです。
        * 受信者のメールサービスからSPFレコードを検査するドメインとして活用
            * 例)受信者：test@toast.com, X-TC-ENVELOPE-FROM： test@cs.toast.comにメール送信をリクエストした場合
                * 受信者のメールサービスから"cs.toast.com"ドメインへSPFレコードの検査を進行
        * 受信者のメールサービスから返送メールを送るメールアドレスとして活用
            * 例)受信者：test@toast.com, X-TC-ENVELOPE-FROM：test@cs.toast.comへメール送信をリクエストした場合
                * 受信側のメールサービスからtest@cs.toast.comメールアドレスへ返送メール送信

* さらに詳細な内容は[カスタムヘッダ(custom header)](https://docs.toast.com/ja/Notification/Email/ja/Overview/#custom-header)ガイドを参照してください。

<span id="dkim"></span>
### DKIM
DKIM(Domain Keys Identified Mail)とは、送信者のなりすましやメール内容の改ざんを受信者側で検証できる技術です。
**DKIM > 設定**ボタンをクリックするとDKIM機能を利用できます。
主な機能は次の通りです。

* DKIM TXTレコード登録と認証
    * **DKIM認証**タブをクリックします。
    * 発行されたTXTレコードの値をドメインのTXTレコードに登録した後、**認証**ボタンをクリックします。
    * ドメインのTXTレコードに"v=DKIM1;k=rsa;p={発行されたRSA publicKey値}"値が存在しないか、一致しない場合、認証に失敗します。
    * ドメインにTXTレコードを登録した後、変更事項が配信されるまで、時間がかかる場合があります。
* DKIM機能の有効化または無効化
    * **DKIM機能**タブをクリックします。
    * **有効化**または**無効化**ボタンをクリックしてDKIM機能を制御できます。<br>

* DKIM機能が正常に動作しているかを確認する方法は次のとおりです。
    * 特定送信ドメインに対してDKIM認証および有効化
    * 特定送信ドメインでメール送信
    * 受信したメールの原本を表示
    * Authentication-Resultsヘッダ値に'dkim=pass'が含まれているかを確認
        * メールサービス提供業者によってdkim=pass情報を表すヘッダは異なる場合があります。

## タグ管理

**タグ管理**タブで、メールを送信する時に使用するタグの作成や、修正または削除ができます。<br>
特定タグをクリックすると、タグに登録されたUIDリストを照会できます。<br>
タグはNotificationサービス全域で使用されます。
- タグは最大2,048個まで作成できます。
- 1つのUIDにタグを16個まで追加できます。

![email_15_201812](https://static.toastoven.net/prod_email/email_15_201812_en.png)

登録されたタグがない場合は、**タグ登録**ボタンをクリックして**タグ登録/修正**ウィンドウで**タグ名**を入力して**登録**ボタンをクリックします。

タグにUIDを登録するには、登録したタグリストで希望するタグを選択して**UID登録**をクリックします。
**UID登録**ウィンドウにUIDを入力し、**登録**をクリックします。

タグ内UIDは一度に最大1,000個まで登録できます。


## UID管理

**UID管理**タブでUIDとメールアドレスを管理できます。

![email_16_201812](https://static.toastoven.net/prod_email/email_16_201812_en.png)

UIDはタグに登録して多数の対象者に簡単にメールを送信できます。

![email_17_201812](https://static.toastoven.net/prod_email/email_17_201812_en.png)

1. **UID登録**ボタンをクリックします。
2. **テンプレートダウンロード**ボタンを押して、CSVファイルに複数のUIDとメールアドレスを入力できます。
    - テンプレートをダウンロードして、下記の形式のように最初の列にはUID、二列目にはメールアドレスを入力します。
3. 入力したファイルを保存し、**UIDファイルアップロード**ボタンをクリックしてアップロードします。
4. **登録**ボタンをクリックします。

## 受信拒否管理

**受信拒否管理**タブで受信拒否対象を管理できます。

![email_20_201812](https://static.toastoven.net/prod_email/email_20_201812_en.png)

現在まで受信拒否したユーザーを照会でき、受信拒否の登録や削除を直接入力できます。

#### 受信拒否を直接入力して登録

![email_21_201812](https://static.toastoven.net/prod_email/email_21_201812_en.png)

1. **受信拒否登録**ボタンをクリックします。
2. **受信拒否登録**ウィンドウで受信拒否メールアドレスを入力します。
    - **追加**ボタンをクリックして最大10人まで登録できます。
3. **登録**ボタンをクリックします。

#### 受信拒否をファイルアップロードで登録

受信拒否ファイルはCSV、テキスト(.txt)、Excel(.xlsx)ファイルでアップロードできます。

![email_22_201812](https://static.toastoven.net/prod_email/email_22_201812_en.png)

**メールアドレス一括登録**をクリックしてファイルをアップロードします。
アップロードが完了したら**登録**ボタンをクリックします。
正常にアップロードされると、**n個のメールアドレスを確認しました。**という文言が表示されます。

![email_23_201812](https://static.toastoven.net/prod_email/email_23_201812_en.png)

アップロードが完了したら、**受信拒否管理**タブでリストを確認できます。

#### 受信拒否の削除

![email_24_201812](https://static.toastoven.net/prod_email/email_24_201812_en.png)

1. 削除する受信拒否メールアドレスを選択します。
2. **受信拒否削除**ボタンをクリックします。
3. **受信拒否解除**ウィンドウで内容を確認し、**はい**ボタンをクリックします。

削除が完了されると、**受信拒否管理**タブで確認できます。

![email_25_201812](https://static.toastoven.net/prod_email/email_20_201812_en.png)

<span id="webhook"></span>
## Webフック管理
Webフックとは、サービスで作業が行われたことをHTTP POSTへ知らせることです。

**Webフック管理**タブでWebフック設定を管理できます。


### Webフック設定の登録
Emailサービス内で特定のイベントが発生した時、Webフック設定に定義されたURLへPOSTリクエストを作成します。<br>
Webフック登録時、下記の設定値を入力します。

- イベントタイプ
    - 現在サポートしているイベントタイプは次のとおりです。
        - 広告メール受信拒否アドレス登録
- 対象URL
    - イベント発生時のデータを受け取るURLです。
        - プロトコルはHTTPSのみサポートします。    
    - POSTリクエストの詳細は[Webフック](./api-guide/#webhook)を参照してください。
- 署名
    - 定義された署名キーはPOSTリクエスト時に、X-Toast-Webhook-Signatureヘッダの値に含まれます。


## 統計情報照会

**統計照会**タブで送信統計を確認できます。
照会期間、統計区分(日付、時間、曜日)、メールタイプ(一般、大量)、テンプレートなどを条件に照会できます。


日付別、時間帯別、曜日別で照会できます。

![email_26_201812](https://static.toastoven.net/prod_email/email_26_201812_en.png)

<span id='personal-information-assignor'></span>

## 발송 설정
메시지 보관 기간 정책에 따라 90일이 지난 발송 이력 데이터를 백업할 수 있습니다.
백업 사용 여부, 파일 확장자, 파일을 업로드할 저장소 정보를 입력하면 해당 저장소에 백업 일자가 포함된 파일이 생성됩니다.

## 個人情報受託会社の告知案内

顧客'がNHN Cloud Emailサービスの利用時、'顧客'と'当社'の間で個人情報処理に関する業務の委託/受託関係が発生するため、韓国情報通信網法および個人情報保護法に従って、委託者である'顧客'は個人情報処理方針を通して'当社'に個人情報を委託した状況(受託会社および業務の内容)を公開する必要があります。

よって'当社'では'顧客'がNHN Cloud Emailサービスを利用するにおいて関連法令を遵守し、委託状況の未公開により過料などの不利益を被らないように下記のように案内できます。

(例)<br>
[個人情報受託会社の告知案内] <br>
Emailサービス利用時、顧客の会社で運営する'個人情報処理方針' >委託状況に次の内容を表記してください。<br>
受託会社：NHN Cloud Corporation<br>
業務の内容：メール送信代行<br>
