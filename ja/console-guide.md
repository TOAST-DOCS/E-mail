## Notification > Email > コンソール使用ガイド

## メール送信

### 一般メール送信

受信者、件名、内容、添付ファイルなどを入力してメールを送信できます。
一般メール送信の場合受信者を直接入力する必要があります。

![email_01_20231023](https://static.toastoven.net/prod_email/email_01_20231023_en.png)

1. **メール送信**タブの**テンプレートの使用有無**で**未使用**を選択します。
2. **メール区分**で**一般メール**を選択します。
3. **送信メール**アドレスを入力します。名前形式で作成すると、送信者名とメールアドレスを入力できます。
    - "送信者名<送信メール>"の形式で送信すると、メールを受け取る人に送信者名とメールアドレスの形式で表示されます。
4. 送信したい時間があれば、**予約送信**欄に入力します。
5. **添付ファイルのアップロード**ボタンをクリックして添付ファイルをアップロードします。
6. **件名とメッセージ内容**を入力します。
7. **受信者**と**CC**にメールアドレスを入力します。

- 添付ファイルは最大10個までアップロード可能で、30MB以下のファイルのみ可能です。
- 添付ファイルの合計は30MBを超えることはできません。
- 最大30MBまで添付可能ですが、受信するメールシステム（gmail.com、naver.comなど）の添付ファイル制限ポリシーにより「制限超過」で拒否されたり、スパム判定率が高くなる可能性があるため、10MB以内で添付することを推奨します。

### 広告性メールの送信

広告性メールを送信できます。

![email_02_20231023](https://static.toastoven.net/prod_email/email_02_20231023_en.png)

1.**メール区分**で広告メールを選択します。
2. **送信メール**アドレスを入力します。名前形式で作成すると、送信者名とメールアドレスを入力できます。
    - "送信者名<送信メール>"の形式で送信すると、メールを受け取る人に送信者名とメールアドレスの形式で表示されます。
3. 送信したい時間があれば、**予約送信**欄に入力します。
4.**添付ファイルアップロード**ボタンをクリックして添付ファイルをアップロードします。
5. **タイトル及びメッセージ内容**を入力します。
6. **受信者**と**CC**にメールアドレスを入力します。

- 件名が始まる部分に「(広告)」フレーズが必ず入っている必要があります。
- 本文に送信者の名称、メールアドレス、電話番号、住所を表示する必要があります。
- 受信拒否リンクが日本語/英文の形で必ず入り、受信を拒否することができる技術的な措置をする必要があります。
- 受信拒否に登録されたユーザーは、広告性メールの送信時に送信されません。

#### 広告メール送信時の注意事項

情報通信網法に基づき、商業性広告メールや企業広報メールを送信する場合、以下の事項を遵守する必要があります。([韓国インターネット振興院関連内容確認](https://spam.kisa.or.kr/spam/cm/cntnts/cntntsView.do?mi=1061&cntntsId=1086)) <br>


1. 広告性メールは、明示的に受信同意をした受信者にのみ送信する必要があります。これに違反して紛争が発生した場合、責任は広告メール送信者にあります。
2. 件名が始まる部分に「（広告）」文言を必ず入れる必要があります。
3. 本文に送信者の名称、メールアドレス、電話番号及び住所を含む送信者情報を表示しなければなりません。
4. 本文に受信者が受信拒否または受信同意を撤回する意思を簡単に表示できるようにするための案内文を明示する必要があります。
5. 本文内に受信者が[受信拒否]などを押して受信拒否または受信同意を撤回するかどうかを簡単に選択できるように技術的措置をしなければならず、この場合、その案内文と技術的措置は日本語と英語する必要があります。

> メメールの受信を希望しない場合は、<strong>[受信拒否]</strong>をクリックしてください。<br>If you do not want to receive it, please click a <strong>[Unsubscription]</strong>


NHN Cloudは、情報通信網法を遵守するため、「広告メール」に対して以下のような技術的措置を提供しています。

- 件名に(広告)文言を挿入します。
- 受信者が受信拒否を選択できるように、日本語と英語の形で受信拒否機能を提供します。
- 受信拒否対象メールアドレスには広告メールを送信しません。

#### 受信拒否リンクとして提供しているキー

| キー | 文言 | 使用例 |
|-------------------------| - |-------------------------------------------------------------------------------------------------------------------------------|
| BLOCK_RECEIVER_LINK | [受信拒否](#) | メールの受信を希望しない場合は ##BLOCK_RECEIVER_LINK##をクリックしてください。 |
| EN_BLOCK_RECEIVER_LINK | [Unsubscription](#) | If you no longer wish to receive these emails, please click the ##EN_BLOCK_RECEIVER_LINK##. |
| JA_BLOCK_RECEIVER_LINK | [受信拒否](#) | メールの受信を希望しない場合、##JA_BLOCK_RECEIVER_LINK##をクリックしてください。 |
| BLOCK_RECEIVER_LINK_URL | - | If you no longer wish to receive these emails, please `<a href='##BLOCK_RECEIVER_LINK_URL##' target='_blank'>click here</a>`. |

### テンプレートメールの送信

あらかじめ作成したメールテンプレートを使うことができます。

![email_03_20231023](https://static.toastoven.net/prod_email/email_03_20231023_en.png)

1. **テンプレート使用有無**で「使用」を選択し、**テンプレート選択**ウィンドウでテンプレートを選択します。
    - テンプレートを作成する方法は下記の**カテゴリー及びテンプレート管理**項目を参照してください。
2. 送信したい時間があれば、**予約送信**欄に入力します。
3.**添付ファイルのアップロード**ボタンをクリックして添付ファイルをアップロードします。
4. **受信者**と**CC**にメールアドレスを入力します。

### 大量メール送信

Excel/CSVフォーマットのテンプレートファイルを使用して大量メールを送信できます。下のタブで**大量送信**を選択します。

![email_04_20231023](https://static.toastoven.net/prod_email/email_04_20231023_en.png)
![email_05_20231023](https://static.toastoven.net/prod_email/email_05_20231023_en.png)

> メールタイトルと内容に##置換キー##形式で入力すると、メール内容をユーザーが指定したデータに置換して送信できます。<strong>Free Markerタイプ</strong>を利用する場合、${置換キー}形式で入力してください。

1. 画面下の大量送信タブで**テンプレートダウンロード**をクリックします。
    - テンプレートの使用有無で使用を選択し、テンプレートのダウンロードをクリックすると、テンプレート日本語識別子が含まれたCSV、XLSX,XLSテンプレートファイルをダウンロードできます。
    - テンプレートファイルに受信者メールアドレスと名前など置換キーに指定する置換データを入力します。
2. **受信者ファイルのアップロード**をクリックして作成したファイルをアップロードします。
    - テンプレートデータを入れたファイルは最大30MBまでアップロードできます。
    - テンプレートデータにエラーがある場合、エラー情報が表示されます。エラー内容を確認して修正します。
    - エラーは合計エラー件数と内容(最大10件)を表示します。
        - **エラーの種類**
            - receive_mail_address列が存在しない場合：receive_mail_address列は受信者メールアドレスを入力する列で、必ず入力する必要があります。
            - 入力されたデータがない場合
            - 受信者メールアドレスまたは置換データの入力が不足している場合
3. 送信したい時間があれば、**予約送信**欄に入力します。
4.**添付ファイルアップロード**ボタンをクリックして添付ファイルをアップロードします。
5. **タイトル及びメッセージ内容**を入力します。
6. **送信**ボタンをクリックすると、**確認後進行、即時送信**の2つを選択して送信できます。
    - 確認後進行：**大量メール送信照会**タブで7日以内にメール受信者確認後、メール送信を行います。(予約送信の場合はサポートされません。)
    - 即時送信：メール受信者を確認せずに即時送信を行います。送信状態は**大量メール送信**タブで結果を確認できます。

### タグメール送信

タグの条件に合ったUIDで送信できます。下のタブで**タグ送信**を選択します。
タグの詳細については、[参考](./console-guide/#_37/)でご確認ください。

![email_06_20231023](https://static.toastoven.net/prod_email/email_06_20231023_en.png)

1. **メール送信**タブの**テンプレートの使用有無**で**未使用**を選択します。
2. 画面下部の**タグ送信**タブを選択し、**タグ選択**ボタンをクリックします。
    - タグの登録は**タグ管理**タブで可能で、UID＆メール保存はUID管理タブで可能です。
3. **タグ選択**ウィンドウで送信したいタグを選択します。
4. 最大4つのタグを選択できます。
    - 選択した複数のタグにAND、OR条件を適用できます。
        - AND：複数のタグすべてに属する受信者だけを対象とする。
        - OR：複数のタグのうち一つ以上のタグに属する受信者を対象とする。
5. 送信したい時間があれば、**予約送信**欄に入力します。
6. **添付ファイルのアップロード**ボタンをクリックして添付ファイルをアップロードします。
7. **件名及びメッセージ内容**を入力します。
8. **送信**ボタンをクリックすると、**確認後進行、即時送信**の2つを選択して送信できます。
    - 確認後進行：**タグメール送信照会**タブで7日以内にメール受信者確認後、メール送信を行います。(予約送信の場合はサポートしません。)
    - 即時送信：メール受信者を確認せずに即時送信を行います。送信状態は**タグメール送信照会**タブで結果を確認できます。

## テンプレート管理

カテゴリーを作成した後、メール送信時に使用するテンプレートを分類して管理できます。

### カテゴリーの追加/修正

![email_07_20231023](https://static.toastoven.net/prod_email/email_07_20231023_en.png)

- **カテゴリー追加及び修正**ボタンをクリックすると、カテゴリーの追加/修正が可能です。
- 必ずカテゴリーを選択した状態で**カテゴリーの追加/修正**ボタンをクリックする必要があります。

### テンプレートの追加/修正

![email_08_20231023](https://static.toastoven.net/prod_email/email_08_20231023_en.png)

- **テンプレートの追加と修正**ボタンをクリックすると、テンプレートの追加/修正が可能です。
- 必ずカテゴリーを選択した状態で**テンプレートの追加/修正**ボタンをクリックする必要があります。
- 認証番号、注文番号、クーポンコード、ポイントなどを置換で入れたい場合、**件名または内容に'##key##'のように置換キーを##で囲んで入力**します。

## 受信拒否管理

**受信拒否管理**タブで受信拒否対象を管理できます。

![email_09_20231023](https://static.toastoven.net/prod_email/email_09_20231023_en.png)

現在までに受信拒否したユーザーを照会することができ、直接入力またはファイルアップロードにより受信拒否を登録または削除できます。

### 受信拒否を直接入力で登録

![email_10_20231023](https://static.toastoven.net/prod_email/email_10_20231023_en.png)

- **受信拒否登録**ウィンドウで受信拒否メールアドレスを入力します。
- **追加**ボタンをクリックして最大10人まで登録できます。

### 受信拒否ファイルをアップロードして登録

![email_11_20231023](https://static.toastoven.net/prod_email/email_11_20231023_en.png)

- 受信拒否ファイルはCSV、テキスト(.txt)、Excel(.xlsx)ファイルでアップロードできます。
- **メールアドレス一括登録**をクリックしてファイルをアップロードします。
- 正常にアップロードされると、**合計n個のメールアドレスが確認されました。**という文言が表示されます。

### 受信拒否の削除

![email_12_20231023](https://static.toastoven.net/prod_email/email_12_20231023_en.png)

- 削除する受信拒否メールアドレスを選択し、**受信拒否削除**ボタンをクリックします。
- 削除が完了すると、**受信拒否管理**タブで確認できます。

## 送信照会

### メールリクエスト別照会

**メールリクエスト別照会**タブで送信日時、受信日時、テンプレート、送信状態などの条件を利用して送信されたメールを照会できます。

![email_13_20231023](https://static.toastoven.net/prod_email/email_13_20231023_en.png)

- リクエストIDまたは送信日時は必須値です。
- 送信日時検索は最大7日以内で検索可能です。
- 受信日時検索は最大1ヶ月以内で検索可能です。
- 詳細を確認するには、リクエストIDまたはタイトルをクリックすると**詳細を見る**ポップアップが表示されます。
- 全画面に表示されるデータはExcelでダウンロードできます。
- リクエスト状態から送信リクエストに対する状態を確認できます。

### メール予約送信照会

**メール予約送信照会**タブで予約送信されたメールを照会できます。

![email_14_20231023](https://static.toastoven.net/prod_email/email_14_20231023_en.png)

- リクエストIDまたは予約日時は必須値です。
- 予約日時検索は最大1ヶ月以内で検索可能です。
- 詳細を確認するには、リクエストIDまたは件名をクリックすると、**詳細を見る**ポップアップが表示されます。
- リクエスト状態から送信リクエストに対する状態を確認できます。予約送信が成功した件はメールリクエスト別照会タブで確認できます。
- 予約待機状態の場合、[キャンセル]ボタンをクリックするか、検索条件による[検索結果予約キャンセル要求]ボタンをクリックすることで予約をキャンセルできます。
    - 予約送信時間10分前の場合、その送信履歴はメールリクエスト別照会タブに移動されます。
    - メールリクエスト別照会タブに移動された場合、送信のキャンセルはできません。

### 大量メール送信照会

**大量メール送信照会**タブでは、大量メール送信予約を照会したり、送信または送信をキャンセルできます。

![email_15_20231023](https://static.toastoven.net/prod_email/email_15_20231023_en.png)

- リクエストIDまたはリクエスト日時は必須値です。
- リクエスト日検索は最大1ヶ月以内で検索可能です。
- 送信/キャンセル：一括メール送信時に**確認後進行**を選択すると、「送信準備完了」状態の件を選択した後、**送信/キャンセル**ボタンをクリックして送信またはキャンセルできます。
- 照会：上部の照会フォームで一括メール送信件を照会できます。照会件のリスト行を選択すると、下段の照会フォームで受信メールと送信情報(送信内容、送信結果)を確認できます。
- 予約待機状態の場合、該当リストを選択して予約キャンセルをできます。
- 進行状態を通じて送信リクエストに対する状態を確認できます。
- 全画面に表示されるデータはExcelでダウンロードできます。

#### 大量メール送信の進行状態

- 待機：受信者ファイルデータを読み込む作業を進める前の状態です。
- 送信準備：受信者ファイルデータ情報を読み込み中の状態です。
- 送信準備完了：メール送信の準備が完了した状態です。予約件(リストの行)を選択すると、受信者別メール送信内容を下部のリストで確認できます。
- 送信待機：メール送信作業を待機している状態です。
- 送信中：メール送信が進行中の状態です。予約件(リストの行)を選択すると、送信進行率を確認できます。
- 送信完了：送信が正常に完了した状態です。
- 送信失敗：送信進行中にエラーが発生した状態です。メールごとの送信状態は、メール受信照会リストで確認できます。
- 送信キャンセル：ユーザーがメールの送信をキャンセルした状態です。

#### 受信者別メール送信照会

大量メール送信件(リストの行)を選択すると、下のリストで受信メール別の送信内容と送信結果を照会できます。

![email_16_20231023](https://static.toastoven.net/prod_email/email_16_20231023_en.png)

**受信者別照会**で該当受信者を選択して、送信内容が正常に置換されたかどうかを確認できます。

![email_17_20231023](https://static.toastoven.net/prod_email/email_17_20231023_en.png)

### タグメール送信照会

**タグメール送信照会**タブでは、タグメールの送信予約を照会したり、送信または送信をキャンセルできます。

![email_18_20231023](https://static.toastoven.net/prod_email/email_18_20231023_en.png)

- リクエストIDまたはリクエスト日時は必須値です。
- リクエスト日検索は最大1ヶ月以内で検索可能です。
- 送信/キャンセル：タグメール送信時に**検収後進行**を選択すると、「送信準備完了」状態の件を選択した後、**送信/キャンセル**ボタンをクリックして送信またはキャンセルできます。
- 照会：上部の照会フォームでタグメール送信件を照会できます。照会件のリスト行を選択すると、下部の照会フォームで受信メールと送信情報(送信内容、送信結果)を確認できます。
- 予約送信時、別途送信キャンセルができません。
- 進行状態を通じて送信リクエストに対する状態を確認できます。
- 全画面に表示されるデータはExcelでダウンロードできます。

#### タグメール送信進行状態

- 待機：受信者ファイルデータを読み込む作業を進める前の状態です。
- 送信準備：受信者ファイルデータ情報を読み込み中の状態です。
- 送信準備完了：メール送信の準備が完了した状態です。予約件(リストの行)を選択すると、受信者別メール送信内容を下のリストで確認できます。
- 送信待機：メール送信作業を待機している状態です。
- 送信中：メール送信が進行中の状態です。予約件(リストの行)を選択すると、送信進行率を確認できます。
- 送信完了：送信が正常に完了した状態です。
- 送信失敗：送信進行中にエラーが発生した状態です。メールごとの送信状態は、メール受信照会リストで確認できます。
- 送信キャンセル：ユーザーがメールの送信をキャンセルした状態です。

#### 受信者別メール送信照会

タグメール送信件(リストの行)を選択して、下部のリストから受信メール別の送信内容及び結果を照会できます。

![email_18-1_20231023](https://static.toastoven.net/prod_email/email_18-1_20231023_en.png)

**受信者別照会**で該当受信者を選択して、送信内容が正常に送信されたかどうかを確認できます。

![email_19_20231023](https://static.toastoven.net/prod_email/email_19_20231023_en.png)

## メールドメイン管理

**メールドメイン管理**タブで送信メールのドメインを管理できます。
送信メールのドメインが個人または会社が所有するドメインの場合、第三者によって悪用される可能性がある問題を補完できる機能です。

* メールサービスを利用するために必ず行わなければならない部分ではありません。
    * ドメインを登録しなくてもメールサービスを利用できますが、サービスの利用に一部制限があります。
    * 詳細は[送信前の注意事項](./Overview/#_2/)を参照してください。
* 個人または会社が所有するドメインでない場合、使用ができません。
    * Daum, Naver, Googleなどのメールアカウント発行サービスを提供する企業のドメインは使用できません。

### メールドメインの登録

**メインドメイン登録**ボタンをクリックして、送信メールに使用するドメインを登録できます。
ドメインはルートドメインのみ登録できます。

### メールドメイン認証

**認証する**ボタンをクリックして、ドメインの所有権を認証できます。
ドメイン登録時に発行されたトークン値をドメインのTXTレコードに登録した後、**認証する**ボタンをクリックします。<br>

* ドメインのTXTレコードに"toast-domain-verification={トークン}"の値が存在しないか、一致しない場合、認証に失敗します。
* ドメインにTXTレコードを登録した後、変更が反映されるまで時間がかかる場合があります。

### メールドメインの保護

**保護する**ボタンをクリックしてドメインを保護できます。
ドメインを保護すると、以下の事項が適用されます。<br>

* 保護されたドメインは、すでに認証されたプロジェクトでのみ使用できます。
    * 同じドメインを認証されたプロジェクトが複数ある場合、そのうちの一つのプロジェクトにのみ保護を適用しても、認証されたプロジェクトはすべてドメインを使用できます。
    * 例) A、Bプロジェクトのメールサービスで「toast.com」ドメインを認証した後、Aプロジェクトで保護を適用する
        * A, Bプロジェクトのみ「toast.com」ドメインを送信アドレスとして使用可能
        * Cプロジェクトでは「toast.com」ドメインが認証されていないため、「toast.com」ドメインを送信アドレスとして使用することはできません

メールドメイン認証と保護機能についてのより詳しい説明は、[ドメイン管理ガイド > ドメイン認証と保護](./domain-verification/)を参照してください。

### メールドメインの共有

**共有 > 設定**ボタンをクリックすると、ドメインを共有できます。
主な機能は次のとおりです。<br>

* ドメインを認証されたプロジェクトの照会
    * 特定のドメインの認証手続きを完了したNHN Cloudプロジェクトのリストを提供します。
* ドメインを他のプロジェクトと共有
    * 複数のプロジェクトに同じドメインを認証する際、認証プロセスを複数回行う必要がありません。<br>
    * 一つのプロジェクトで認証を受けた後、共有機能を利用して他のプロジェクトのメールサービスアプリキーを入力すると、ドメインの共有が可能です。

### 반송 메일 설정

**반송 설정** 버튼을 클릭해 반송 메일을 설정할 수 있습니다.
반송 메일은 메일 발송 시 수신자의 메일 서비스에서 메일을 수신하지 못했을 때 발송되는 메일입니다.
메일 주소를 no-reply@{도메인} 또는 noreply@{도메인}으로 설정할 경우 반송 설정과 관련없이 반송 메일이 발송되지 않습니다.

### サブドメインの登録

**メインサブドメイン > 設定**ボタンをクリックしてサブドメインを登録できます。
登録されたルートドメインのサブドメインのみ登録できます。
登録されたサブドメインはメール送信時に**ユーザー指定ヘッダ(custom header)**機能で利用できます。

* サブドメインを使用できるユーザー指定ヘッダ(custom header)
    * ヘッダ名：X-TC-ENVELOPE-FROM
    * ヘッダ値：サブドメイン
    * 主な機能は次のとおりです。
        * 受信者のメールサービスでSPFレコードを検査するドメインとして活用
            * 例)受信者：test@toast.com, X-TC-ENVELOPE-FROM：test@cs.toast.comにメール送信をリクエストした場合
                * 受信者のメールサービスで「cs.toast.com」ドメインでSPFレコードを検査する
        * 受信者のメールサービスで返信メールを送信するメールアドレスとして活用
            * 例)受信者：test@toast.com, X-TC-ENVELOPE-FROM：test@cs.toast.comにメール送信をリクエストした場合
                * 受信側のメールサービスでtest@cs.toast.comメールアドレスに返信メールを送信

* 詳細は[ユーザー指定ヘッダ(custom header)](./console-guide/#custom-header)ガイドを参照してください。

### SPF, DKIM, DMARC認証

NHN Cloud Emailサービスのメール送信(SMTP)サーバーを通じてユーザー所有のドメインが含まれたメールアドレスで送信されるため、ユーザー所有のドメインがサービスされているDNSに追加設定が必要です。

DNSに追加設定が必要な内訳はSPF、DKIM、DMARCがあり、TXTレコード形式で追加設定が可能です。
DNS追加設定に関する詳細は**ドメイン管理ガイド**を参照してください。

- [ドメイン管理ガイド > SPF](./spf-record/)
- [ドメイン管理ガイド > DKIM](./dkim-record/)
- [ドメイン管理ガイド > DMARC](./dmarc-record/)

## タグ管理

**タグ管理**タブでメールを送信する際に使用するタグを作成したり、修正または削除できます。

特定のタグをクリックすると、タグに登録されたUIDリストを照会できます。タグとUID用語の意味は[参考](./console-guide/#_37/)でご確認ください。

![email_20_20231023](https://static.toastoven.net/prod_email/email_20_20231023_en.png)

1. 登録されたタグがない場合は、**タグ登録**ボタンをクリックした後、**タグ登録/修正**ウィンドウで**タグ名**を入力し、**登録**ボタンをクリックします。
    - タグは最大2,048個まで作成できます。
2. タグにUIDを登録するには、登録したタグリストから目的のタグを選択し、**UID登録**をクリックします。
3. **UID登録**ウィンドウにUIDを入力し、**登録**をクリックします。
    - タグ内のUIDは一度に最大1,000個まで登録できます。

## UID管理

**UID管理**タブでUIDとメールアドレスを管理できます。

UIDはタグに登録して、多数の対象者に簡単にメールを送信できます。タグとUIDの用語の意味は[参考](./console-guide/#_37/)でご確認ください。

![email_21_20231023](https://static.toastoven.net/prod_email/email_21_20231023_en.png)

![email_22_20231023](https://static.toastoven.net/prod_email/email_22_20231023_en.png)

1. **UID登録**ボタンをクリックします。
2. **テンプレートのダウンロード**ボタンを押すと、CSVファイルで複数のUIDとメールアドレスを入力できます。
    - テンプレートをダウンロードした後、最初の列にはUID、2番目の列にはメールアドレスを入力します。
3. 入力したファイルを保存した後、**UIDファイルアップロード**ボタンをクリックしてアップロードします。
    - テンプレート作成後、アップロード時に確認されたメール数を確認できます。
4. **登録**ボタンをクリックします。

## Webフック管理

Webフックとは、サービスで何らかの操作が行われたことを知らせる機能を指します。<br>
Webフックを登録する場合、Emailサービス内の特定のイベントが発生すると、Webフック設定で定義されたURLにHTTP POSTリクエストを生成します。Webフックの設定は**Webフックの管理**タブで管理できます。

#### Webフック設定の登録

Webフック登録時に下記の設定値を入力します。

- イベントタイプ
    - 現在サポートされているイベントタイプは次のとおりです。
        - メッセージ送信結果コードの更新、広告メール受信拒否アドレスの登録
- 対象URL
    - イベント発生時にデータを受け取るURLです。
        - プロトコルはHTTPSのみサポートします。
    - POSTリクエストの仕様は[Webhook](./webhook)を参照してください。
- 署名
    - 定義された署名鍵はPOSTリクエスト時にX-Toast-Webhook-Signatureヘッダの値として含まれます。

![email_23_20231023](https://static.toastoven.net/prod_email/email_23_20231023_en.png)

1. 登録するイベントタイプを選択します。
2. Webフックで送信されるデータを受信できるURLアドレスを記載します。
3. 登録するWebフック署名を入力します(必須ではない)。
4. 検証を受け、追加ボタンをクリックしてWebフックを登録します。

登録完了したWebフックは**Webフック登録リスト**で確認できます。

## 統計情報照会

**(旧)統計**タブで送信統計を確認できます。
照会期間、統計区分（日付、時間、曜日）、メールタイプ（一般、大量）、テンプレートなどを条件として照会できます。

日別、タイムゾーン別、曜日別に照会できます。

![email_24_20231023](https://static.toastoven.net/prod_email/email_24_20231023_en.png)

## 統計イベントキーの管理
**統計イベントキー管理**タブで統計イベントキーを管理できます。作成時に 名前、説明、イベント収集期間を設定できます。イベント収集期間を設定しない場合、収集期間は無期限に設定されます。作成された統計イベントキーは、メッセージ送信時に設定できます。統計イベントキーが設定されたメッセージの送信結果は**統計**タブにて統計イベントキーで検索できます。

<span id="stats"></span>

## 統計照会
最近30日以内に収集されたメッセージの受信/確認データを検索できます。コンソールで**統計照会**を選択します。メッセージ、トークンの登録や削除に関する統計を検索できます。

1. 期間を検索条件として設定できます。
    - 簡易期間設定ボタンのほか、手動設定で1分を最小期間、30日を最大期間として設定できます。
2. タイプでグラフの表示方法を設定できます。
    - デフォルトは、設定された期間に基づいて自動的に最適化されたタイプでグラフを表示します。
3. メッセージ統計では、統計イベントキー、テンプレートID、メールタイプで検索できます。

## 送信設定

#### バックアップ設定

- メッセージの保管期間ポリシーに基づき、90日を過ぎた送信履歴データをバックアップできます。
- バックアップの使用有無、ファイル拡張子、ファイルをアップロードするストレージ情報を入力すると、そのストレージにバックアップ日を含むファイルが作成されます。

<span id='personal-information-assignor'></span>

## 参考

<span id='tags-and-uids'></span>

### タグとUID

#### サービス用語

|用語|  説明|
|---|---|
|タグ(tag)｜UIDを分類する体系。<br>UIDに複数のタグを付けることで、ユーザーが簡単にUID情報を検索して使用できます。|
|UID｜ユーザーを区別するID(識別子)。<br>一つのUIDには複数の連絡先を登録し、送信に使用できます。|
|連絡先(contact)｜連絡をするために決めた場所。<br>NotificationではPush、Email、SMSの3つの商品で連絡先を登録できます。<br>Pushはトークン、Emailはメールアドレス、SMSは電話番号です。|

#### タグを使用して送信

* 受信者情報であるメールアドレスの代わりに、タグを選択してメールを送信できる機能です。

1. UIDを登録します。

* **UID管理**タブでUIDと一つ以上のメールアドレスを登録します。
* 詳細は[UID管理](./console-guide/#uid)を参照してください。

2. タグを登録します。

* **タグ管理**タブでタグを登録します。
* 詳細は[タグ管理](./console-guide/#_31)を参照してください。

3. タグにUIDを登録します。

* **タグ管理**タブで登録したタグにUIDを登録します。

4. タグを選択した後、メールを送信します。

* **メール送信**タブでメールアドレスの代わりに**タグ送信**を選択してタグを登録します。
* メールはタグに登録されたUIDのメールアドレスに送信されます。
* 詳細は[タグメール送信](./console-guide/#_8)を参照してください。

#### 他の商品のタグ機能との関係

* もし同じプロジェクトでPushまたはSMS商品を使用している場合、Emailで使用しているタグとUID情報を再登録せずに一緒に使用できます。
* 各商品のコンソールで同じUIDに他の連絡先を追加できます。

### ユーザー指定ヘッダ(Custom header)

* 受信メールにユーザー指定ヘッダを追加して送信できます。
* NHN Cloud Emailサービスでは、下記のヘッダ以外に[RFC 822](https://www.ietf.org/rfc/rfc0822.txt)に記載された形式に従うヘッダーを使用できます。

#### リクエストできないヘッダ

* From
* To
* Cc
* Bcc
* Date
* Subject
* Content-Disposition
* Message-ID
* Sender
* Reply-To
* Newsgroups
* Content-ID
* Content-MD5
* MIME-Version
* Content-Transfer-Encoding
* Content-Description

#### 構成

| 用語 | 説明 |
|---|---|
|ヘッダ名| 追加するヘッダの名前。<br>英字と数字(a-z, A-Z, 0-9)、ハイフン(-)だけを使用して1-50文字の間で作成してください。|
|ヘッダ値| 追加するヘッダの値。<br>1-1000バイトの間で作成します。<br>ASCII以外の文字は、Base64でエンコードしてから送信します。|

### データ保管期間

Emailサービスは保管ポリシーに基づき、最近90日間のデータのみを保管します。
保管期間を過ぎたデータは削除され、照会できません。
